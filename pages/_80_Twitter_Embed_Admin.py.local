"""
TwitteråŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ç®¡ç†ãƒšãƒ¼ã‚¸

ã“ã®ãƒšãƒ¼ã‚¸ã¯ã€TwitteråŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®ç®¡ç†ç”»é¢ã‚’æä¾›ã—ã¾ã™ã€‚
ç®¡ç†è€…èªè¨¼ãŒå¿…è¦ã§ã™ã€‚

è¦ä»¶: 4.1, 4.2, 4.3, 4.4, 4.5
"""

import streamlit as st
from footer import display_footer
from src.ui.twitter_embed_admin import render_twitter_embed_admin
from src.config import setup_logging

# ãƒ­ã‚®ãƒ³ã‚°ã®åˆæœŸåŒ–
if "logging_initialized" not in st.session_state:
    setup_logging()
    st.session_state.logging_initialized = True

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="TwitteråŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰ç®¡ç† - ã—ã®ã†ãŸã‚¿ã‚¤ãƒ ",
    page_icon="ğŸ¦",
    layout="wide",
)

# ã‚«ã‚¹ã‚¿ãƒ CSSã®é©ç”¨
try:
    with open("style.css", encoding="utf-8") as f:
        st.markdown(f"<style>{f.read()}</style>", unsafe_allow_html=True)
except FileNotFoundError:
    pass
except Exception:
    pass

# ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒãƒã‚§ãƒƒã‚¯é–¢æ•°
def is_local_environment():
    """
    ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    
    ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ç‰¹å¾´ã‹ã‚‰åˆ¤å®šã—ã¾ã™ï¼š
    - ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ: .gitãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¾ãŸã¯DockerfileãŒå­˜åœ¨
    - æœ¬ç•ªãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ: ã©ã¡ã‚‰ã‚‚å­˜åœ¨ã—ãªã„
    
    Returns:
        bool: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®å ´åˆTrue
    """
    import os
    
    # .gitãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    git_dir_exists = os.path.isdir(".git")
    
    # Dockerfileã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
    dockerfile_exists = os.path.isfile("Dockerfile")
    
    # .gitãŒå­˜åœ¨ã™ã‚‹ã€ã¾ãŸã¯DockerfileãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
    return git_dir_exists or dockerfile_exists

# ç®¡ç†ç”»é¢ã‚’è¡¨ç¤ºï¼ˆç’°å¢ƒã«å¿œã˜ã¦æ©Ÿèƒ½ã‚’åˆ¶é™ï¼‰
render_twitter_embed_admin(enable_admin_features=is_local_environment())

# ãƒ•ãƒƒã‚¿ãƒ¼ã®è¡¨ç¤º
st.markdown("---")
display_footer()
